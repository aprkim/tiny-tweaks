<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tiny Body - Smart changes. Real progress.</title>
    
    <!-- Branding -->
    <meta name="description" content="Track your weight, food, and exercise. Smart changes made simple.">
    <meta name="theme-color" content="#BF3143">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon.svg">
    
    <!-- OG Tags -->
    <meta property="og:title" content="Tiny Body">
    <meta property="og:description" content="Smart changes. Real progress.">
    <meta property="og:type" content="website">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Chart.js for graphs -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Main App Container -->
    <div id="app" class="app-container">
        
        <!-- Navigation -->
        <nav class="bottom-nav">
            <button class="nav-btn active" data-screen="today">
                <span class="nav-icon"><i class="fas fa-calendar-day"></i></span>
                <span class="nav-label">Today</span>
            </button>
            <button class="nav-btn" data-screen="presets">
                <span class="nav-icon"><i class="fas fa-star"></i></span>
                <span class="nav-label">Presets</span>
            </button>
            <button class="nav-btn" data-screen="progress">
                <span class="nav-icon"><i class="fas fa-chart-line"></i></span>
                <span class="nav-label">Progress</span>
            </button>
            <button class="nav-btn" data-screen="settings">
                <span class="nav-icon"><i class="fas fa-cog"></i></span>
                <span class="nav-label">Settings</span>
            </button>
        </nav>

        <!-- Today Screen -->
        <div id="today-screen" class="screen active">
            <header class="app-header">
                <a href="https://tinywins.space" class="back-link">
                    <i class="fas fa-arrow-left"></i> TinyWins
                </a>
                <h1 class="app-title">Tiny Body</h1>
                <p class="app-tagline">Smart changes. Real progress.</p>
            </header>

            <!-- Date Selector -->
            <div class="card date-card">
                <div class="date-selector">
                    <button id="prev-day" class="date-nav-btn">‹</button>
                    <div class="date-display">
                        <input type="date" id="date-input" class="date-input">
                        <div class="day-info">
                            <span id="day-of-week" class="day-of-week">Friday</span>
                            <span class="day-separator">•</span>
                            <span id="day-type" class="day-type weekend">Weekday</span>
                        </div>
                    </div>
                    <button id="next-day" class="date-nav-btn">›</button>
                </div>
            </div>

            <!-- Weight Card -->
            <div class="card weight-card">
                <h2 class="card-title"><i class="fas fa-weight"></i> Weight</h2>
                <div class="weight-inputs">
                    <div class="input-group">
                        <label for="weight-lb">Pounds (lb)</label>
                        <input type="number" id="weight-lb" placeholder="0.0" step="0.1" min="0">
                    </div>
                    <div class="conversion-arrow">↔</div>
                    <div class="input-group">
                        <label for="weight-kg">Kilograms (kg)</label>
                        <input type="number" id="weight-kg" placeholder="0.0" step="0.1" min="0">
                    </div>
                </div>
            </div>

            <!-- Summary Card -->
            <div class="card summary-card">
                <h2 class="card-title"><i class="fas fa-clipboard-list"></i> Today's Summary</h2>
                <div class="summary-grid">
                    <div class="summary-item">
                        <span class="summary-label">Calories Eaten</span>
                        <span id="total-calories-eaten" class="summary-value">0</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Calories Burned</span>
                        <span id="total-calories-burned" class="summary-value">0</span>
                    </div>
                    <div class="summary-item net">
                        <span class="summary-label">Net Calories</span>
                        <span id="net-calories" class="summary-value">0</span>
                    </div>
                </div>
            </div>

            <!-- Food Log -->
            <div class="card food-card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-utensils"></i> Food Log</h2>
                    <div class="card-actions">
                        <button id="add-preset-btn" class="btn-secondary btn-sm">+ Preset</button>
                        <button id="add-food-btn" class="btn-primary btn-sm">+ Food</button>
                    </div>
                </div>
                <div id="food-list" class="item-list">
                    <p class="empty-state">No food logged yet. Tap + Food to start!</p>
                </div>
            </div>

            <!-- Exercise Log -->
            <div class="card exercise-card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-dumbbell"></i> Exercise Log</h2>
                    <div class="card-actions">
                        <button id="add-exercise-preset-btn" class="btn-secondary btn-sm">+ Preset</button>
                        <button id="add-exercise-btn" class="btn-primary btn-sm">+ Exercise</button>
                    </div>
                </div>
                <div id="exercise-list" class="item-list">
                    <p class="empty-state">No exercise logged yet. Tap + Exercise to start!</p>
                </div>
            </div>
        </div>

        <!-- Presets Screen -->
        <div id="presets-screen" class="screen">
            <header class="screen-header">
                <h1 class="screen-title">Presets</h1>
            </header>

            <!-- Preset Tabs -->
            <div class="preset-tabs">
                <button class="preset-tab active" data-preset-tab="food">
                    <i class="fas fa-utensils"></i> Food
                </button>
                <button class="preset-tab" data-preset-tab="exercise">
                    <i class="fas fa-dumbbell"></i> Exercise
                </button>
            </div>

            <!-- Food Presets Tab Content -->
            <div id="food-presets-tab" class="preset-tab-content active">
                <div class="preset-tab-header">
                    <button id="add-new-preset-btn" class="btn-primary">+ New Preset</button>
                </div>
                <div id="presets-list" class="presets-container">
                    <p class="empty-state">No presets yet. Create your first one!</p>
                </div>
            </div>

            <!-- Exercise Presets Tab Content -->
            <div id="exercise-presets-tab" class="preset-tab-content">
                <div class="preset-tab-header">
                    <button id="add-new-exercise-preset-btn" class="btn-primary">+ New Preset</button>
                </div>
                <div id="exercise-presets-list" class="presets-container">
                    <p class="empty-state">No presets yet. Create your first one!</p>
                </div>
            </div>
        </div>

        <!-- Progress Screen -->
        <div id="progress-screen" class="screen">
            <header class="screen-header">
                <h1 class="screen-title">Weight Progress</h1>
                <div class="unit-toggle">
                    <button id="toggle-lb" class="unit-btn active">lb</button>
                    <button id="toggle-kg" class="unit-btn">kg</button>
                </div>
            </header>
            <div class="chart-container">
                <canvas id="weight-chart"></canvas>
            </div>
            <div class="chart-info">
                <p id="chart-summary" class="chart-summary"></p>
            </div>
            <div class="progress-actions">
                <button id="clear-progress-btn" class="btn-secondary">Clear Progress</button>
            </div>
        </div>

        <!-- Settings Screen -->
        <div id="settings-screen" class="screen">
            <header class="screen-header">
                <h1 class="screen-title">Settings</h1>
                <p class="screen-subtitle">Manage sync and preferences</p>
            </header>

            <!-- Cross-Device Sync Section -->
            <div class="settings-section">
                <div class="settings-section-header">
                    <i class="fas fa-key"></i>
                    <h3>Cross-Device Sync</h3>
                    <span class="sync-pill" id="syncPill">OFF</span>
                </div>
                <p class="settings-section-description">Use a sync code to access your data across devices and browsers.</p>

                <button class="settings-action-btn" onclick="showSyncCodeCard()">Show My Sync Code</button>

                <div id="syncCodeCard" class="sync-code-card" style="display: none;">
                    <div class="sync-code-text-container">
                        <div id="syncCodeText" class="sync-code-text">—</div>
                    </div>
                    <button class="sync-copy-btn" onclick="copySyncCode()">Copy</button>
                </div>

                <div class="sync-input-container">
                    <input type="text" id="enterSyncCodeInput" placeholder="Enter sync code from another device or browser">
                    <button class="sync-link-btn" onclick="submitSyncCode()">Link</button>
                </div>
            </div>

            <!-- Data Management Section -->
            <div class="settings-section">
                <div class="settings-section-header">
                    <i class="fas fa-trash-alt"></i>
                    <h3>Data Management</h3>
                </div>

                <!-- Reset This Browser Option -->
                <div class="settings-option-card">
                    <div class="settings-option-header">
                        <i class="fas fa-redo-alt"></i>
                        <span>Reset This Browser</span>
                    </div>
                    <p class="settings-option-description">Clear all weight, food, exercise data, and presets from this browser only.</p>
                    <button class="settings-action-btn secondary" onclick="confirmResetBrowser()">Reset Browser</button>
                </div>

                <!-- Delete All Data Option -->
                <div class="settings-option-card danger">
                    <div class="settings-option-header">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>Delete All Data</span>
                    </div>
                    <p class="settings-option-description">Permanently remove all your data from this browser. This action cannot be undone.</p>
                    <button class="settings-action-btn danger" onclick="confirmDeleteAllData()">Delete Everything</button>
                </div>
            </div>

            <!-- Export/Import Data Section -->
            <div class="settings-section">
                <div class="settings-section-header">
                    <i class="fas fa-exchange-alt"></i>
                    <h3>Export / Import Data</h3>
                </div>
                <p class="settings-section-description">Backup or restore your weight, food, exercise, and preset data.</p>

                <!-- Export Section -->
                <div class="settings-option-card">
                    <div class="settings-option-header">
                        <i class="fas fa-download"></i>
                        <span>Export Data</span>
                    </div>
                    <p class="settings-option-description">Download your data and optionally include your history.</p>
                    <button id="export-data-btn" class="settings-action-btn secondary">Export Data</button>
                </div>

                <!-- Import Section -->
                <div class="settings-option-card">
                    <div class="settings-option-header">
                        <i class="fas fa-upload"></i>
                        <span>Import Data</span>
                    </div>
                    <p class="settings-option-description">Upload a previously exported JSON file to restore your data.</p>
                    <button class="settings-action-btn secondary" onclick="document.getElementById('import-file-input').click()">Import Data</button>
                    <input type="file" id="import-file-input" accept="application/json,.json" class="hidden">
                </div>
            </div>
        </div>

    </div>

    <!-- Food Entry Modal -->
    <div id="food-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Add Food</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="food-form" class="modal-form">
                <div class="form-group">
                    <label for="food-name">Food Name</label>
                    <input type="text" id="food-name" placeholder="e.g., Lunch salad" autocomplete="on" spellcheck="true" autocorrect="on" autocapitalize="words" required>
                </div>
                
                <!-- Food Item Search and Add -->
                <div class="form-group">
                    <label>Add Food Items</label>
                    <div class="preset-search-row">
                        <input type="text" id="food-search-input" placeholder="Search food..." autocomplete="on" spellcheck="true" autocorrect="on">
                        <button type="button" class="btn-secondary btn-sm" id="food-search-btn" title="Search"><i class="fas fa-search"></i></button>
                        <input type="number" id="food-search-calories" placeholder="Calories" min="0" readonly>
                        <button type="button" class="btn-secondary btn-sm" id="food-add-item-btn">+ Add</button>
                    </div>
                </div>
                
                <!-- Added Items List -->
                <div class="form-group">
                    <div id="food-items-list" class="preset-items-list">
                        <p class="empty-state">No items added yet</p>
                    </div>
                </div>
                
                <!-- Total Calories -->
                <div class="form-group">
                    <label for="food-total-calories">Total Calories</label>
                    <input type="number" id="food-total-calories" placeholder="0" min="0">
                </div>
                
                <div class="form-group">
                    <label for="food-note">Note</label>
                    <textarea id="food-note" placeholder="e.g., 3 eggs, 20 pistachios, spinach..." rows="2" autocomplete="on" spellcheck="true" autocorrect="on" autocapitalize="sentences"></textarea>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" id="cancel-food-btn">Cancel</button>
                    <button type="submit" class="btn-primary">Save Food</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Exercise Entry Modal -->
    <div id="exercise-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Add Exercise</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="exercise-form" class="modal-form">
                <div class="form-group">
                    <label for="exercise-name">Exercise Name</label>
                    <input type="text" id="exercise-name" placeholder="e.g., Running, Yoga" autocomplete="on" spellcheck="true" autocorrect="on" autocapitalize="words" required>
                </div>
                <div class="form-group">
                    <label for="exercise-duration">Duration (minutes)</label>
                    <input type="number" id="exercise-duration" placeholder="0" min="0" required>
                </div>
                <div class="form-group">
                    <label for="exercise-calories">Calories Burned (optional)</label>
                    <input type="number" id="exercise-calories" placeholder="0" min="0">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" id="cancel-exercise-btn">Cancel</button>
                    <button type="submit" class="btn-primary">Save Exercise</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Preset Modal -->
    <div id="preset-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Create Preset Meal</h2>
            </div>
            <form id="preset-form" class="modal-form">
                <div class="form-group">
                    <label for="preset-name">Preset Name</label>
                    <input type="text" id="preset-name" placeholder="e.g., My standard lunch salad" autocomplete="on" spellcheck="true" autocorrect="on" autocapitalize="words" required>
                </div>
                
                <!-- Food Item Search and Add -->
                <div class="form-group">
                    <label>Add Food Items</label>
                    <div class="preset-search-row">
                        <input type="text" id="preset-search-input" placeholder="Search food..." autocomplete="on" spellcheck="true" autocorrect="on">
                        <button type="button" class="btn-secondary btn-sm" id="preset-search-btn" title="Search"><i class="fas fa-search"></i></button>
                        <input type="number" id="preset-search-calories" placeholder="Calories" min="0" readonly>
                        <button type="button" class="btn-secondary btn-sm" id="preset-add-item-btn">+ Add</button>
                    </div>
                </div>
                
                <!-- Added Items List -->
                <div class="form-group">
                    <div id="preset-items-list" class="preset-items-list">
                        <p class="empty-state">No items added yet</p>
                    </div>
                </div>
                
                <!-- Total Calories -->
                <div class="form-group">
                    <label for="preset-total-calories">Total Calories</label>
                    <input type="number" id="preset-total-calories" placeholder="0" min="0">
                </div>
                
                <div class="form-group">
                    <label for="preset-description">Note</label>
                    <textarea id="preset-description" placeholder="Additional notes..." rows="2" autocomplete="on" spellcheck="true" autocorrect="on" autocapitalize="sentences"></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" id="cancel-preset-btn">Cancel</button>
                    <button type="submit" class="btn-primary">Save Preset</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Preset Select Modal -->
    <div id="preset-select-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Select Preset Meal</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div id="preset-select-list" class="preset-select-list">
                <p class="empty-state">No presets available. Create one first!</p>
            </div>
            <div class="preset-select-footer">
                <button id="add-new-preset-from-select-btn" class="btn-primary">+ New Preset</button>
            </div>
        </div>
    </div>

    <!-- Exercise Preset Modal -->
    <div id="exercise-preset-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Create Preset Exercise</h2>
            </div>
            <form id="exercise-preset-form" class="modal-form">
                <div class="form-group">
                    <label for="exercise-preset-name">Preset Name</label>
                    <input type="text" id="exercise-preset-name" placeholder="e.g., Morning run" autocomplete="on" spellcheck="true" autocorrect="on" autocapitalize="words" required>
                </div>

                <div class="form-group">
                    <label for="exercise-preset-duration">Duration (minutes)</label>
                    <input type="number" id="exercise-preset-duration" placeholder="0" min="0" required>
                </div>

                <div class="form-group">
                    <label for="exercise-preset-calories">Calories Burned (optional)</label>
                    <input type="number" id="exercise-preset-calories" placeholder="0" min="0">
                </div>

                <div class="form-group">
                    <label for="exercise-preset-description">Note</label>
                    <textarea id="exercise-preset-description" placeholder="Additional notes..." rows="2" autocomplete="on" spellcheck="true" autocorrect="on" autocapitalize="sentences"></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" id="cancel-exercise-preset-btn">Cancel</button>
                    <button type="submit" class="btn-primary">Save Preset</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Exercise Preset Select Modal -->
    <div id="exercise-preset-select-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Select Preset Exercise</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div id="exercise-preset-select-list" class="preset-select-list">
                <p class="empty-state">No presets available. Create one first!</p>
            </div>
            <div class="preset-select-footer">
                <button id="add-new-exercise-preset-from-select-btn" class="btn-primary">+ New Preset</button>
            </div>
        </div>
    </div>

    <!-- Custom Alert Modal -->
    <div id="custom-alert-modal" class="modal custom-dialog">
        <div class="modal-content dialog-content">
            <div class="dialog-body">
                <div class="dialog-icon dialog-icon-info">
                    <i class="fas fa-info-circle"></i>
                </div>
                <p id="alert-message" class="dialog-message"></p>
            </div>
            <div class="dialog-actions">
                <button class="btn-primary" id="alert-ok-btn">OK</button>
            </div>
        </div>
    </div>

    <!-- Custom Confirm Modal -->
    <div id="custom-confirm-modal" class="modal custom-dialog">
        <div class="modal-content dialog-content">
            <div class="dialog-body">
                <div class="dialog-icon dialog-icon-warning">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <p id="confirm-message" class="dialog-message"></p>
            </div>
            <div class="dialog-actions">
                <button class="btn-secondary" id="confirm-cancel-btn">Cancel</button>
                <button class="btn-primary" id="confirm-ok-btn">OK</button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="app.js"></script>
</body>
</html>
